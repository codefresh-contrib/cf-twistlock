version: '1.0'

steps:

  buildimage:
    type: build
    description: image build step
    dockerfile: Dockerfile
    image_name: codefreshplugins/cf-twistlock
    tags: [ "latest", "master-c81e6d4" ]

  push_image:
    type: push
    candidate: ${{buildimage}}
    tags: [ "latest", "master-c81e6d4" ]
    when:
      branch:
        only:
          - master
  push_image1:
    type: push
    candidate: ${{buildimage}}
    tags: [ "latest", "master-c81e6d4" ]

  push_image_nexus_latest:
    title: Push to Nexus Repo (latest)
    type: push
    candidate: ${{buildimage}}
    tags: [ "latest", "master-c81e6d4" ]
    registry: sonatype-docker-internal
    when:
      branch:
        only:
          - master

  push_image_neuxs_gitbranch_gitsha:
    title: Push to Nexus Repo (gitbranch + gitsha)
    type: push
    candidate: ${{buildimage}}
    tags: [ "latest", "master-c81e6d4" ]
    registry: sonatype-docker-internal
